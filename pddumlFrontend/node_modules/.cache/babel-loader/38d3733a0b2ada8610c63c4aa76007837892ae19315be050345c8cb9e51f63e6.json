{"ast":null,"code":"import _slicedToArray from\"/home/tanmay/Desktop/Tanmay Engineering/BEProject/FrontEnd/pddumlFrontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useRef,useEffect,useState}from\"react\";import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Camera(){var videoRef=useRef(null);var photoRef=useRef(null);var _useState=useState(false),_useState2=_slicedToArray(_useState,2),hasPhoto=_useState2[0],setHasPhoto=_useState2[1];var _useState3=useState(\"user\"),_useState4=_slicedToArray(_useState3,2),facingMode=_useState4[0],setFacingMode=_useState4[1];var _useState5=useState(\" \"),_useState6=_slicedToArray(_useState5,2),plantname=_useState6[0],setPlantname=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),result=_useState8[0],setResult=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),cnnimg=_useState10[0],setImgCNN=_useState10[1];var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),imgfile=_useState12[0],setImgfile=_useState12[1];var getVideo=function getVideo(){navigator.mediaDevices.getUserMedia({video:{width:256,height:256,facingMode:facingMode}}).then(function(stream){var video=videoRef.current;video.srcObject=stream;video.play();}).catch(function(err){console.error(err);});};useEffect(function(){getVideo();},[videoRef,facingMode]);var takePhoto=function takePhoto(){var canvas=document.getElementById('myCanvas');var width=256;var height=256;var video=videoRef.current;var photo=photoRef.current;photo.width=width;photo.height=height;var ctx=photo.getContext(\"2d\");ctx.drawImage(video,0,0,width,height);var imageData=ctx.getImageData(0,0,photo.width,photo.height);var pixels=imageData.data;var temp_arr=[];var line=[];// Loop through the pixel data and log the values\nconsole.log(pixels.length);var j=0;for(var i=0;i<pixels.length;i+=4){if(j%256===0&&j>0){temp_arr.push(line);line=[];}var red=pixels[i];var green=pixels[i+1];var blue=pixels[i+2];j+=1;line.push([red,green,blue]);// let alpha = pixels[i + 3];\n// console.log('Pixel ' + i / 4 + ':', red, green, blue, alpha);\n}temp_arr.push(line);setImgCNN(temp_arr);setHasPhoto(true);};var closePhoto=function closePhoto(){var photo=photoRef.current;var ctx=photo.getContext(\"2d\");ctx.clearRect(0,0,photo.width,photo.height);setHasPhoto(false);};var switchCamera=function switchCamera(){if(facingMode===\"user\"){setFacingMode(\"environment\");}else{setFacingMode(\"user\");}};function saveCanvasImage(canvasId,filename){var canvas=document.getElementById(canvasId);console.log(canvasId);var dataURL=canvas.toDataURL(\"image/jpeg\");var link=document.createElement(\"a\");link.href=dataURL;link.download=filename;document.body.appendChild(link);link.click();document.body.removeChild(link);}function handleSaveButtonClick(){saveCanvasImage(\"myCanvas\",\"myImage.jpeg\");console.log(photoRef);}var onFileUpload=function onFileUpload(){var canvas=document.getElementById('myCanvas');var imgDataUrl=canvas.toDataURL();axios.post(\"http://127.0.0.1:8000/gettomoato/\",{// imagefile: imgDataUrl,\nCNNImg:cnnimg}).then(function(data){alert(\"Plant - \"+data.data.plantname+\"\\nDisease\"+data.data.disease+\"\\nConfidence\"+data.data.confidence+\"\\n\"+data.data.comments);// setResult(\"Plant - \"+data.data.plantname+\"\\nDisease\"+data.data.disease+\"\\nConfidence\"+data.data.confidence+\"\\n\"+data.data.comments)\n}).catch(function(error){// console.error(error);\n});};return/*#__PURE__*/_jsxs(\"div\",{className:\"CameraApp\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"box\",children:/*#__PURE__*/_jsx(\"h3\",{children:result})}),/*#__PURE__*/_jsxs(\"div\",{className:\"Camera\",children:[/*#__PURE__*/_jsx(\"video\",{ref:videoRef}),/*#__PURE__*/_jsx(\"p\",{children:/*#__PURE__*/_jsx(\"button\",{className:\"btn\",onClick:takePhoto,children:\"Capture\"})}),/*#__PURE__*/_jsx(\"p\",{children:/*#__PURE__*/_jsx(\"button\",{className:\"btn\",onClick:switchCamera,children:\"Switch Camera\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:'result'+(hasPhoto?'hasPhoto':''),children:/*#__PURE__*/_jsxs(\"form\",{children:[/*#__PURE__*/_jsx(\"canvas\",{id:\"myCanvas\",ref:photoRef}),/*#__PURE__*/_jsx(\"p\",{children:/*#__PURE__*/_jsx(\"button\",{className:\"btn\",onClick:handleSaveButtonClick,children:\"Download\"})})]})})]});}export default Camera;","map":{"version":3,"names":["React","useRef","useEffect","useState","axios","Camera","videoRef","photoRef","hasPhoto","setHasPhoto","facingMode","setFacingMode","plantname","setPlantname","result","setResult","cnnimg","setImgCNN","imgfile","setImgfile","getVideo","navigator","mediaDevices","getUserMedia","video","width","height","then","stream","current","srcObject","play","catch","err","console","error","takePhoto","canvas","document","getElementById","photo","ctx","getContext","drawImage","imageData","getImageData","pixels","data","temp_arr","line","log","length","j","i","push","red","green","blue","closePhoto","clearRect","switchCamera","saveCanvasImage","canvasId","filename","dataURL","toDataURL","link","createElement","href","download","body","appendChild","click","removeChild","handleSaveButtonClick","onFileUpload","imgDataUrl","post","CNNImg","alert","disease","confidence","comments"],"sources":["/home/tanmay/Desktop/Tanmay Engineering/BEProject/FrontEnd/pddumlFrontend/src/Camera.js"],"sourcesContent":["import React, { useRef, useEffect, useState } from \"react\";\nimport axios from 'axios';\n\nfunction Camera() {\n  const videoRef = useRef(null);\n  const photoRef = useRef(null);\n  const [hasPhoto, setHasPhoto] = useState(false);\n  const [facingMode, setFacingMode] = useState(\"user\");\n  const[plantname,setPlantname]= useState(\" \");\n  const [result,setResult] = useState(\"\")\n  const [cnnimg, setImgCNN]=useState(\"\");\n  const [imgfile,setImgfile]= useState([]);\n\n\n  const getVideo = () => {\n    navigator.mediaDevices\n      .getUserMedia({\n        video: { width: 256, height: 256, facingMode: facingMode }\n      })\n      .then((stream) => {\n        let video = videoRef.current;\n        video.srcObject = stream;\n        video.play();\n      })\n      .catch((err) => {\n        console.error(err);\n      });\n  };\n\n  useEffect(() => {\n    getVideo();\n  }, [videoRef, facingMode]);\n\n  const takePhoto = () => {\n    const canvas = document.getElementById('myCanvas');\n    const width = 256;\n    const height = 256;\n\n    let video = videoRef.current;\n    let photo = photoRef.current;\n\n    photo.width = width;\n    photo.height = height;\n\n    let ctx = photo.getContext(\"2d\");\n    ctx.drawImage(video, 0, 0, width, height);\n    let imageData = ctx.getImageData(0, 0, photo.width, photo.height);\nlet pixels = imageData.data;\nlet temp_arr = []\nlet line = []\n// Loop through the pixel data and log the values\nconsole.log(pixels.length)\nlet j =0 ;\nfor (let i = 0; i < pixels.length; i += 4) {\n  if (j%256 === 0 && j >0 ){\n    temp_arr.push(line)\n    line=[];\n  }\n  \n  let red = pixels[i];\n  let green = pixels[i + 1];\n  let blue = pixels[i + 2];\n  j+=1;\n  line.push([red,green,blue])\n\n  // let alpha = pixels[i + 3];\n  // console.log('Pixel ' + i / 4 + ':', red, green, blue, alpha);\n}\ntemp_arr.push(line)\nsetImgCNN(temp_arr)\n\n    setHasPhoto(true);\n  };\n\n  const closePhoto = () => {\n    let photo = photoRef.current;\n    let ctx = photo.getContext(\"2d\");\n\n    ctx.clearRect(0, 0, photo.width, photo.height);\n\n    setHasPhoto(false);\n  };\n\n  const switchCamera = () => {\n    if (facingMode === \"user\") {\n      setFacingMode(\"environment\");\n    } else {\n      setFacingMode(\"user\");\n    }\n  };\n\n  function saveCanvasImage(canvasId, filename) {\n    const canvas = document.getElementById(canvasId);\n    console.log(canvasId);\n    const dataURL = canvas.toDataURL(\"image/jpeg\");\n    const link = document.createElement(\"a\");\n    link.href = dataURL;\n    link.download = filename;\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  }\n\n  function handleSaveButtonClick() {\n    saveCanvasImage(\"myCanvas\", \"myImage.jpeg\");\n    console.log(photoRef);\n  }\n   \n\n  const  onFileUpload = () => {\n    const canvas = document.getElementById('myCanvas');\nconst imgDataUrl = canvas.toDataURL();\n\naxios.post(\"http://127.0.0.1:8000/gettomoato/\", {\n  // imagefile: imgDataUrl,\n  CNNImg: cnnimg\n})\n.then(data => {\n  alert(\"Plant - \"+data.data.plantname+\"\\nDisease\"+data.data.disease+\"\\nConfidence\"+data.data.confidence+\"\\n\"+data.data.comments)\n  // setResult(\"Plant - \"+data.data.plantname+\"\\nDisease\"+data.data.disease+\"\\nConfidence\"+data.data.confidence+\"\\n\"+data.data.comments)\n})\n.catch(error => {\n  // console.error(error);\n});\n  };\n  \n\n  \n\n\n  return (\n    <div className=\"CameraApp\">\n      <div className=\"box\">\n          <h3>{result}</h3>\n      </div>\n      <div className=\"Camera\">\n        <video ref={videoRef}></video>\n        <p>\n          <button className=\"btn\" onClick={takePhoto}>\n            Capture\n          </button></p>\n          <p><button className=\"btn\" onClick={switchCamera}>\n            Switch Camera\n          </button></p>\n          </div>\n      <div className={'result' + (hasPhoto ? 'hasPhoto' : '')}>\n        <form >\n          <canvas id=\"myCanvas\" ref={photoRef}></canvas>\n          {/* <p><button className='btn' onClick={closePhoto}>Re-Capture</button></p> */}\n          <p><button className='btn' onClick={handleSaveButtonClick}>Download</button></p>\n          \n         \n          {/* <p><button className='btn'  value=\"Submit\" onClick={()=>{onFileUpload()}}>Submit</button></p> */}\n          {/* <canvas id=\"myCanvas\" width=\"400\" height=\"400\"></canvas> */}\n        </form>\n        \n  \n  \n  \n\n      </div>\n    </div>\n  );\n}\nexport default Camera;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}